TOPLEVEL_LANG ?= verilog
SIM ?= verilator
DUT = ibex_super_system
TOPLEVEL = $(DUT)
MODULE = tb_$(DUT)

FUSESOC_DIR = /home/patrick/Projects/RISCV/ibex_super_system/build/lowrisc_ibex_ibex_super_system_0
# SRAM_FILE = /home/patrick/Projects/RISCV/ibex_super_system/sw/build/demo/demo.vmem

VERILOG_SOURCES = 
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_pkg_0.1/rtl/ibex_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/src/dm_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_prim_pkg_0.1/prim_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_ram_1p_pkg_0/rtl/prim_ram_1p_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_ram_2p_pkg_0/rtl/prim_ram_2p_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_util_0.1/rtl/prim_util_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_cipher_pkg_0.1/rtl/prim_cipher_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_tracer_0.1/rtl/ibex_tracer_pkg.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_assert_0.1/rtl/prim_assert.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_super_system_core_0/rtl/system/ibex_super_system.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_super_system_core_0/rtl/system/dm_top.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_super_system_core_0/rtl/system/gpio.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_super_system_core_0/rtl/system/uart.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_22_16_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_22_16_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_28_22_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_28_22_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_39_32_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_39_32_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_64_57_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_64_57_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_72_64_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_72_64_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_hamming_22_16_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_hamming_22_16_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_hamming_39_32_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_hamming_39_32_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_hamming_72_64_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_hamming_72_64_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_hamming_76_68_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_hamming_76_68_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_22_16_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_22_16_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_28_22_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_28_22_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_39_32_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_39_32_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_64_57_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_64_57_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_72_64_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_72_64_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_hamming_22_16_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_hamming_22_16_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_hamming_39_32_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_hamming_39_32_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_hamming_72_64_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_hamming_72_64_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_hamming_76_68_dec.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_secded_0.1/rtl/prim_secded_inv_hamming_76_68_enc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_generic_buf_0/rtl/prim_generic_buf.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_generic_clock_gating_0/rtl/prim_generic_clock_gating.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_generic_flop_0/rtl/prim_generic_flop.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_generic_flop_2sync_0/rtl/prim_generic_flop_2sync.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_xilinx_buf_0/rtl/prim_xilinx_buf.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_xilinx_clock_gating_0/rtl/prim_xilinx_clock_gating.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_xilinx_clock_mux2_0/rtl/prim_xilinx_clock_mux2.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_xilinx_flop_0/rtl/prim_xilinx_flop.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_icache_0.1/rtl/ibex_icache.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_tracer_0.1/rtl/ibex_tracer.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_buf_0/prim_buf.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_clock_gating_0/prim_clock_gating.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_flop_0/prim_flop.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_flop_2sync_0/prim_flop_2sync.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_cipher_0/rtl/prim_subst_perm.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_cipher_0/rtl/prim_present.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_cipher_0/rtl/prim_prince.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_generic_clock_mux2_0/rtl/prim_generic_clock_mux2.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_generic_ram_1p_0/rtl/prim_generic_ram_1p.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_generic_ram_2p_0/rtl/prim_generic_ram_2p.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_lfsr_0.1/rtl/prim_lfsr.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_clock_mux2_0/prim_clock_mux2.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_ram_2p_0/prim_ram_2p.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_badbit_ram_1p_0/prim_badbit_ram_1p.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_alu.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_branch_predict.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_compressed_decoder.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_controller.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_cs_registers.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_csr.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_counter.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_decoder.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_ex_block.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_fetch_fifo.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_id_stage.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_if_stage.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_load_store_unit.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_multdiv_fast.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_multdiv_slow.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_prefetch_buffer.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_pmp.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_wb_stage.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_dummy_instr.sv
# VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl/ibex_core.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_ram_1p_0/prim_ram_1p.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_fifo_0/rtl/prim_fifo_async_sram_adapter.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_fifo_0/rtl/prim_fifo_async.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_fifo_0/rtl/prim_fifo_sync.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_generic_clock_inv_0/rtl/prim_generic_clock_inv.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_sim_shared_0/rtl/ram_1p.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_sim_shared_0/rtl/ram_2p.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_sim_shared_0/rtl/bus.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_sim_shared_0/rtl/sim/simulator_ctrl.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_sim_shared_0/rtl/timer.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_abstract_clock_inv_0/prim_clock_inv.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_ram_1p_adv_0.1/rtl/prim_ram_1p_adv.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_prim_ram_1p_scr_0.1/rtl/prim_ram_1p_scr.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_top_0.1/rtl/ibex_register_file_ff.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_top_0.1/rtl/ibex_register_file_fpga.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_top_0.1/rtl/ibex_register_file_latch.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_top_0.1/rtl/ibex_lockstep.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_top_0.1/rtl/ibex_top.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/debug_rom/debug_rom.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/debug_rom/debug_rom_one_scratch.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/src/dm_sba.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/src/dm_csrs.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/src/dm_mem.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/src/dmi_cdc.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/src/dmi_jtag.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/pulp_riscv_debug_module_0/vendor/pulp_riscv_dbg/src/dmi_jtag_tap.sv
VERILOG_SOURCES += $(FUSESOC_DIR)/src/lowrisc_ibex_ibex_top_tracing_0.1/rtl/ibex_top_tracing.sv

COMPILE_ARGS  = 
COMPILE_ARGS += -Wall
COMPILE_ARGS += -Wno-SELRANGE
COMPILE_ARGS += -Wno-WIDTH
COMPILE_ARGS += -Wno-DECLFILENAME
COMPILE_ARGS += -Wno-PINMISSING
COMPILE_ARGS += -Wno-PINCONNECTEMPTY
COMPILE_ARGS += -Wno-PINNOCONNECT
COMPILE_ARGS += -CFLAGS "-std=c++11 \
                         -Wall \
						 -DVM_TRACE_FMT_FST \
						 -DTOPLEVEL_NAME=ibex_super_system \
						 -g"
COMPILE_ARGS += -LDFLAGS "-pthread -lutil -lelf"
COMPILE_ARGS += --unroll-count 72
COMPILE_ARGS += --timescale-override 1ns/1ps
COMPILE_ARGS += --trace
COMPILE_ARGS += --trace-fst
COMPILE_ARGS += --trace-structs
COMPILE_ARGS += --trace-params
COMPILE_ARGS += --trace-max-array 1024
COMPILE_ARGS += --trace-threads 2
COMPILE_ARGS += -I$(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl
COMPILE_ARGS += -I$(FUSESOC_DIR)/src/lowrisc_dv_dv_fcov_macros_0
COMPILE_ARGS += -I$(FUSESOC_DIR)/src/lowrisc_prim_util_get_scramble_params_0/rtl
COMPILE_ARGS += -I$(FUSESOC_DIR)/src/lowrisc_prim_util_memload_0/rtl
COMPILE_ARGS += -I$(FUSESOC_DIR)/src/lowrisc_prim_assert_0.1/rtl
COMPILE_ARGS += -I$(FUSESOC_DIR)/src/lowrisc_ibex_ibex_core_0.1/rtl

MODULE = tb_ibex_super_system
TOPLEVEL = ibex_super_system

include $(shell cocotb-config --makefiles)/Makefile.sim


#  -DSRAMInitFile=$(SRAM_FILE)